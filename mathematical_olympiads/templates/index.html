{% extends "base.html" %}
{% block title %}–ì–ª–∞–≤–Ω–∞—è{% endblock %}


{% block content %}


{% include 'nav.html' %}


<div class="container mb-4">
    <h3>üëã {{ user.first_name }}</h3>
    {% if user.is_staff %}

    <p style="margin-top: 1rem">
        <a class="btn btn-primary btn-lg btn-block" href="/admin/" role="button"><i
                class="bi bi-box-arrow-in-right"></i>
            –ü–µ—Ä–µ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</a>

        <a class="btn btn-success btn-lg btn-block" href="{% url 'get_csv' 1 %}" role="button"><i
                class="bi bi-download"></i></i>
            –°–∫–∞—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã 1 —Ç—É—Ä–∞ (CSV)</a>


        <a class="btn btn-success btn-lg btn-block" href="{% url 'get_csv' 2 %}" role="button"><i
                class="bi bi-download"></i></i>
            –°–∫–∞—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã 2 –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç—É—Ä–∞ (CSV)</a>

        <a class="btn btn-success btn-lg btn-block" href="{% url 'get_csv' 3 %}" role="button"><i
                class="bi bi-download"></i></i>
            –°–∫–∞—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã 2 –ø–æ–≤—ã—à–µ–Ω–Ω–æ–≥–æ —Ç—É—Ä–∞ (CSV)</a>

        <a class="btn btn-dark btn-lg btn-block" href="https://convertio.co/ru/csv-xls/" target="_blank" role="button"><i
                class="bi bi-cloud-arrow-up"></i></i>
            –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä CSV –≤ XLS (EXCEL)</a>
    </p>
    {% else %}

    <p>–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ–º –≤–∞—Å –Ω–∞ –æ–ª–∏–º–ø–∏–∞–¥–µ!</p>
    {% endif %}
</div>

<div class="container">
    <!--         –æ–ª–∏–º–ø–∏–∞–¥–∞ 1 –ø—Ä–æ—à–ª–∞-->
    <!--        {{ olimp1_finished.0 }}-->
    <!--        –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –æ–ª–∏–º–ø–∏–∞–¥–∞ 1-->
    <!--        {{ olimp1_work.0 }}-->
    <!--        –∂–¥—ë—Ç –Ω–∞—á–∞–ª–∞-->
    <!--        {{ olimp1_waiting_to_begin.0.end_time | date:"c" }}-->

    {% if not olimp1_finished and not olimp1_work and not olimp1_waiting_to_begin %}
    <h2>–ù–∞ —Å–∞–π—Ç–µ –Ω–µ—Ç –æ–ª–∏–º–ø–∏–∞–¥ 1 —Ç—É—Ä–∞.</h2>
    {% else %}
    <h4>1 —Ç—É—Ä</h4>

    <!--         –æ–ª–∏–º–ø–∏–∞–¥–∞ 1 –ø—Ä–æ—à–ª–∞-->
    {% if olimp1_finished %}
    <div class="card shadow-sm" style="margin-bottom: 1rem">
        <img class="card-img-top" src="{{ olimp1_finished.0.image_url }}"
            style="width: 100%; height: 12rem; object-fit: cover; filter: brightness(35%);">
        <div class="card-body">
            <h5 class="card-title">{{ olimp1_finished.0.title }}</h5>
            <p class="card-text">{{ olimp1_finished.0.description }}</p>
            <button type="button" class="btn btn-outline-danger" disabled><i class="bi bi-lock-fill"></i> –û–ª–∏–º–ø–∏–∞–¥–∞
                –∑–∞–≤–µ—Ä—à–µ–Ω–∞</button>
        </div>
    </div>
    {% endif %}

    <!--        –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –æ–ª–∏–º–ø–∏–∞–¥–∞ 1-->
    {% if olimp1_work %}

    <div class="card shadow-sm" style="margin-bottom: 1rem">
        <img class="card-img-top" src="{{ olimp1_work.0.image_url }}"
            style="width: 100%; height: 12rem; object-fit: cover;">
        <div class="card-body">
            <h5 class="card-title">{{ olimp1_work.0.title }}</h5>
            <p class="card-text">{{ olimp1_work.0.description }}<br>
                <div id="count_close"></div>
            </p>
            {% if olimp1_work.0.end_time == timetracker.end_time or timetracker == None %}

            {% if first_task %}
            <!--                        –µ—Å—Ç—å –ø–µ—Ä–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ –≤ –æ–ª–∏–º–ø–∏–∞–¥–µ-->
            <a href="{% url 'task' olimp1_work.0.pk first_task.pk %}" class="btn btn-outline-primary"><i
                    class="bi bi-unlock-fill"></i> –ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ª–∏–º–ø–∏–∞–¥–µ</a>

            {% else %}
            <!--                 –Ω–µ—Ç –∑–∞–¥–∞–Ω–∏—è       -->
            <button type="button" class="btn btn-outline-secondary" disabled><i class="bi bi-lock-fill"></i> –í –æ–ª–∏–º–ø–∏–∞–¥–µ
                0 –∑–∞–¥–∞–Ω–∏–π</button>
            {% endif %}

            {% else %}
            <button type="button" class="btn btn-outline-danger" disabled><i class="bi bi-lock-fill"></i> –í—ã –¥–æ—Å—Ä–æ—á–Ω–æ
                –∑–∞–≤–µ—Ä—à–∏–ª–∏ –æ–ª–∏–º–ø–∏–∞–¥—É</button>
            {% endif %}
            <!--                        }    % url 'olimp' olimp1_work.0.pk %      {               -->
        </div>
    </div>


    <script>
        let time = {{olimp1_work_to_end_seconds}};
        const countDownEl = document.getElementById("count_close");
        updateCountdown();
        setInterval(updateCountdown, 1000);

        function updateCountdown() {
            if (time != -1) {
                let hours = Math.floor(time / 3600);
                let minutes = Math.floor((time - hours * 3600) / 60);
                let seconds = Math.floor((time - hours * 3600) - minutes * 60);

                hours = hours < 10 ? "0" + hours : hours;
                minutes = minutes < 10 ? "0" + minutes : minutes;
                seconds = seconds < 10 ? "0" + seconds : seconds;

                if (time > 300) {
                    countDownEl.innerHTML =
                        `–ó–∞–∫—Ä–æ–µ—Ç—Å—è —á–µ—Ä–µ–∑ <span class="badge badge-info" >${hours}:${minutes}:${seconds}</span>`;
                } else {
                    countDownEl.innerHTML =
                        `–ó–∞–∫—Ä–æ–µ—Ç—Å—è —á–µ—Ä–µ–∑ <span class="badge badge-danger" >${hours}:${minutes}:${seconds}</span>`;
                }
                time--;
            } else {
                window.location.reload();
            }
        }
    </script>
    {% endif %}

    <!--        –∂–¥—ë—Ç –Ω–∞—á–∞–ª–∞-->
    {% if olimp1_waiting_to_begin %}
    <div class="card shadow-sm" style="margin-bottom: 1rem">
        <img class="card-img-top" src="{{ olimp1_waiting_to_begin.0.image_url }}"
            style="width: 100%; height: 12rem; object-fit: cover; filter: brightness(35%);">
        <div class="card-body">
            <h5 class="card-title">{{ olimp1_waiting_to_begin.0.title }}</h5>
            <p class="card-text">{{ olimp1_waiting_to_begin.0.description }}</p>
            <button type="button" class="btn btn-outline-primary" disabled id="count_open"></button>
        </div>
    </div>


    <script>
        let time = {{olimp1_waiting_to_begin_seconds}};
        const countDownEl = document.getElementById("count_open");
        updateCountdown();
        setInterval(updateCountdown, 1000);

        function updateCountdown() {
            if (time != -1) {
                let hours = Math.floor(time / 3600);
                let minutes = Math.floor((time - hours * 3600) / 60);
                let seconds = Math.floor((time - hours * 3600) - minutes * 60);

                hours = hours < 10 ? "0" + hours : hours;
                minutes = minutes < 10 ? "0" + minutes : minutes;
                seconds = seconds < 10 ? "0" + seconds : seconds;

                countDownEl.innerHTML =
                    `<i class="bi bi-calendar-event"></i> –û—Ç–∫—Ä–æ–µ—Ç—Å—è —á–µ—Ä–µ–∑ ${hours}:${minutes}:${seconds}`;
                time--;
            } else {
                window.location.reload();
            }
        }
    </script>

    {% endif %}


    {% if not olimp1_finished %}
        <br><hr><h5>–ü–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è 1 —Ç—É—Ä–∞ –æ–ª–∏–º–ø–∏–∞–¥—ã –æ—Ç–∫—Ä–æ–µ—Ç—Å—è 2 —Ç—É—Ä.</h5>
    {% endif %}

    {% endif %}









    {% if olimp1_finished %}





    {% if not olimp2_finished and not olimp2_work and not olimp2_waiting_to_begin %}
        <br><hr><h2>–ù–∞ —Å–∞–π—Ç–µ –Ω–µ—Ç –æ–ª–∏–º–ø–∏–∞–¥ 2 —Ç—É—Ä–∞.</h2>
    {% else %}
    <h4>2 —Ç—É—Ä</h4>

<!--         –æ–ª–∏–º–ø–∏–∞–¥–∞ 2 –ø—Ä–æ—à–ª–∞-->
    {% if olimp2_finished %}
    <div class="card shadow-sm" style="margin-bottom: 1rem">
        <img class="card-img-top" src="{{ olimp2_finished.0.image_url }}"
            style="width: 100%; height: 12rem; object-fit: cover; filter: brightness(35%);">
        <div class="card-body">
            <h5 class="card-title">{{ olimp2_finished.0.title }}</h5>
            <p class="card-text">{{ olimp2_finished.0.description }}</p>
            <button type="button" class="btn btn-outline-danger" disabled><i class="bi bi-lock-fill"></i> –û–ª–∏–º–ø–∏–∞–¥–∞
                –∑–∞–≤–µ—Ä—à–µ–Ω–∞</button>
        </div>
    </div>
    {% endif %}

    <!--        –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –æ–ª–∏–º–ø–∏–∞–¥–∞ 2-->
    {% if olimp2_work %}

    <div class="card shadow-sm" style="margin-bottom: 1rem">
        <img class="card-img-top" src="{{ olimp2_work.0.image_url }}"
            style="width: 100%; height: 12rem; object-fit: cover;">
        <div class="card-body">
            <h5 class="card-title">{{ olimp2_work.0.title }}</h5>
            <p class="card-text">{{ olimp2_work.0.description }}<br>
                <div id="count_close2"></div>
            </p>
            {% if olimp2_work.0.end_time == timetracker_olimp2.end_time or timetracker_olimp2 == None %}

                    {% if first_task_olimp2 %}
                            <!--                        –µ—Å—Ç—å –ø–µ—Ä–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ –≤ –æ–ª–∏–º–ø–∏–∞–¥–µ-->
                            <a href="{% url 'task' olimp2_work.0.pk first_task_olimp2.pk %}" class="btn btn-outline-primary"><i
                                    class="bi bi-unlock-fill"></i> –ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ª–∏–º–ø–∏–∞–¥–µ</a>

                    {% else %}
                            <!--                 –Ω–µ—Ç –∑–∞–¥–∞–Ω–∏—è       -->
                            <button type="button" class="btn btn-outline-secondary" disabled><i class="bi bi-lock-fill"></i> –í –æ–ª–∏–º–ø–∏–∞–¥–µ
                                0 –∑–∞–¥–∞–Ω–∏–π</button>
                    {% endif %}

            {% else %}
                    <button type="button" class="btn btn-outline-danger" disabled><i class="bi bi-lock-fill"></i> –í—ã –¥–æ—Å—Ä–æ—á–Ω–æ
                        –∑–∞–≤–µ—Ä—à–∏–ª–∏ –æ–ª–∏–º–ø–∏–∞–¥—É</button>
            {% endif %}
            <!--                        }    % url 'olimp' olimp1_work.0.pk %      {               -->
        </div>
    </div>


    <script>
        let time = {{olimp2_work_to_end_seconds}};
        const countDownEl = document.getElementById("count_close2");
        updateCountdown();
        setInterval(updateCountdown, 1000);

        function updateCountdown() {
            if (time != -1) {
                let hours = Math.floor(time / 3600);
                let minutes = Math.floor((time - hours * 3600) / 60);
                let seconds = Math.floor((time - hours * 3600) - minutes * 60);

                hours = hours < 10 ? "0" + hours : hours;
                minutes = minutes < 10 ? "0" + minutes : minutes;
                seconds = seconds < 10 ? "0" + seconds : seconds;

                if (time > 300) {
                    countDownEl.innerHTML =
                        `–ó–∞–∫—Ä–æ–µ—Ç—Å—è —á–µ—Ä–µ–∑ <span class="badge badge-info" >${hours}:${minutes}:${seconds}</span>`;
                } else {
                    countDownEl.innerHTML =
                        `–ó–∞–∫—Ä–æ–µ—Ç—Å—è —á–µ—Ä–µ–∑ <span class="badge badge-danger" >${hours}:${minutes}:${seconds}</span>`;
                }
                time--;
            } else {
                window.location.reload();
            }
        }
    </script>
    {% endif %}

    <!--        –∂–¥—ë—Ç –Ω–∞—á–∞–ª–∞-->
    {% if olimp2_waiting_to_begin %}
    <div class="card shadow-sm" style="margin-bottom: 1rem">
        <img class="card-img-top" src="{{ olimp2_waiting_to_begin.0.image_url }}"
            style="width: 100%; height: 12rem; object-fit: cover; filter: brightness(35%);">
        <div class="card-body">
            <h5 class="card-title">{{ olimp2_waiting_to_begin.0.title }}</h5>
            <p class="card-text">{{ olimp2_waiting_to_begin.0.description }}</p>
            <button type="button" class="btn btn-outline-primary" disabled id="count_open2"></button>
        </div>
    </div>


    <script>
        let time = {{olimp2_waiting_to_begin_seconds}};
        const countDownEl = document.getElementById("count_open2");
        updateCountdown();
        setInterval(updateCountdown, 1000);

        function updateCountdown() {
            if (time != -1) {
                let hours = Math.floor(time / 3600);
                let minutes = Math.floor((time - hours * 3600) / 60);
                let seconds = Math.floor((time - hours * 3600) - minutes * 60);

                hours = hours < 10 ? "0" + hours : hours;
                minutes = minutes < 10 ? "0" + minutes : minutes;
                seconds = seconds < 10 ? "0" + seconds : seconds;

                countDownEl.innerHTML =
                    `<i class="bi bi-calendar-event"></i> –û—Ç–∫—Ä–æ–µ—Ç—Å—è —á–µ—Ä–µ–∑ ${hours}:${minutes}:${seconds}`;
                time--;
            } else {
                window.location.reload();
            }
        }
    </script>

    {% endif %}



    {% endif %}

    {% endif %}
</div>



{% endblock %}